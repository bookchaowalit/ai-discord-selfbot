flowchart TD
    A[User sends a message] --> B{Is the message from\nthe target user?}
    B -- No --> Z[Ignore]
    B -- Yes --> C[Add message to history]
    C --> D{Is this the last message?}
    D -- No --> Z
    D -- Yes --> E[Filter Agent:\nIs the message casual/friendly?]
    E -- No --> F[Skip response\nLog/alert in terminal]
    E -- Yes --> G[Main Agent:\nGenerate casual reply]
    G --> H{Is the reply empty?}
    H -- Yes --> F
    H -- No --> I[Wait random delay (1-3s)]
    I --> J[Send reply to chat]
